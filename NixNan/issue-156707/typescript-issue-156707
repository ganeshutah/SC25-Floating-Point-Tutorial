Script started on 2025-07-13 14:00:55-06:00 [TERM="xterm-256color" TTY="/dev/pts/1" COLUMNS="106" LINES="42"]
[?2004h]0;ganesh@dknuth: ~/repos/pytorch/issue-156707[01;32mganesh@dknuth[00m:[01;34m~/repos/pytorch/issue-156707[00m$ py[K[KLD_PER[K[KRELOAD=~/re[K[Knixnan.so pytorch issue-[K[K[K[K[K[Krun.py 
[?2004l------------- NVBit (NVidia Binary Instrumentation Tool v1.7.2) Loaded --------------
NVBit core environment variables (mostly for nvbit-devs):
ACK_CTX_INIT_LIMITATION = 0 - if set, no warning will be printed for nvbit_at_ctx_init()
            NVDISASM = nvdisasm - override default nvdisasm found in PATH
            NOBANNER = 0 - if set, does not print this banner
       NO_EAGER_LOAD = 0 - eager module loading is turned on by NVBit to prevent potential NVBit tool deadlock, turn it off if you want to use the lazy module loading feature
---------------------------------------------------------------------------------
         INSTR_BEGIN = 0 - Beginning of the instruction interval where to apply instrumentation
           INSTR_END = 4294967295 - End of the instruction interval where to apply instrumentation
        TOOL_VERBOSE = 0 - Enable verbosity inside the tool
   ENABLE_FUN_DETAIL = 0 - Enable detailed function information for kernel
     PRINT_ILL_INSTR = 0 - Print the instruction which caused the exception
            SAMPLING = 0 - Instrument a repeat kernel every SAMPLING times
----------------------------------------------------------------------------------
pytorch: command not found
[?2004h]0;ganesh@dknuth: ~/repos/pytorch/issue-156707[01;32mganesh@dknuth[00m:[01;34m~/repos/pytorch/issue-156707[00m$ LD_PRELOAD=~/nixnan.so pytorch run.py [C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[C[1P[1P[1P[1P[1@h[1@o[1@n
[?2004l------------- NVBit (NVidia Binary Instrumentation Tool v1.7.2) Loaded --------------
NVBit core environment variables (mostly for nvbit-devs):
ACK_CTX_INIT_LIMITATION = 0 - if set, no warning will be printed for nvbit_at_ctx_init()
            NVDISASM = nvdisasm - override default nvdisasm found in PATH
            NOBANNER = 0 - if set, does not print this banner
       NO_EAGER_LOAD = 0 - eager module loading is turned on by NVBit to prevent potential NVBit tool deadlock, turn it off if you want to use the lazy module loading feature
---------------------------------------------------------------------------------
         INSTR_BEGIN = 0 - Beginning of the instruction interval where to apply instrumentation
           INSTR_END = 4294967295 - End of the instruction interval where to apply instrumentation
        TOOL_VERBOSE = 0 - Enable verbosity inside the tool
   ENABLE_FUN_DETAIL = 0 - Enable detailed function information for kernel
     PRINT_ILL_INSTR = 0 - Print the instruction which caused the exception
            SAMPLING = 0 - Instrument a repeat kernel every SAMPLING times
----------------------------------------------------------------------------------
CPU: [nan, nan, nan]
Traceback (most recent call last):
  File "/home/ganesh/repos/pytorch/issue-156707/run.py", line 15, in <module>
    out_mps = F.scaled_dot_product_attention(q.to('mps'), k.to('mps'), v.to('mps'), attn_mask=mask.to('mps'))
RuntimeError: PyTorch is not linked with support for mps devices
[?2004h]0;ganesh@dknuth: ~/repos/pytorch/issue-156707[01;32mganesh@dknuth[00m:[01;34m~/repos/pytorch/issue-156707[00m$ LD_PRELOAD=~/nixnan.so python run.py [K[K[K[K-variant-cuda.py 
[?2004l------------- NVBit (NVidia Binary Instrumentation Tool v1.7.2) Loaded --------------
NVBit core environment variables (mostly for nvbit-devs):
ACK_CTX_INIT_LIMITATION = 0 - if set, no warning will be printed for nvbit_at_ctx_init()
            NVDISASM = nvdisasm - override default nvdisasm found in PATH
            NOBANNER = 0 - if set, does not print this banner
       NO_EAGER_LOAD = 0 - eager module loading is turned on by NVBit to prevent potential NVBit tool deadlock, turn it off if you want to use the lazy module loading feature
---------------------------------------------------------------------------------
         INSTR_BEGIN = 0 - Beginning of the instruction interval where to apply instrumentation
           INSTR_END = 4294967295 - End of the instruction interval where to apply instrumentation
        TOOL_VERBOSE = 0 - Enable verbosity inside the tool
   ENABLE_FUN_DETAIL = 0 - Enable detailed function information for kernel
     PRINT_ILL_INSTR = 0 - Print the instruction which caused the exception
            SAMPLING = 0 - Instrument a repeat kernel every SAMPLING times
----------------------------------------------------------------------------------
CPU: [nan, nan, nan]
WARNING: Do not call CUDA memory allocation in nvbit_at_ctx_init(). It will cause deadlocks. Do them in nvbit_tool_init(). If you encounter deadlocks, remove CUDA API calls to debug.
#nixnan: Initializing GPU context...
#nixnan: Could not open kernel_whitelist.txt!
#nixnan: Could not open kernel_blacklist.txt!
#nixnan: instrumenting all kernels
#nixnan: running kernel [void at::native::vectorized_elementwise_kernel] ...
#nixnan: running kernel [void at::native::elementwise_kernel] ...
#nixnan: running kernel [fmha_cutlassF_f32_aligned_64x64_rf_sm80] ...
#nixnan: error [infinity] detected in operand 0 of instruction FSEL R11, R6, c[0x0][0x168], !P0 ; in function void at::native::vectorized_elementwise_kernel at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P2 FADD R44, R44, R3 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P2 FADD R43, R43, R3 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction FMUL R44, R44, 1.4426950216293334961 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction FMUL R44, R44, 1.4426950216293334961 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction FMUL R43, R43, 1.4426950216293334961 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction FMUL R43, R43, 1.4426950216293334961 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction FADD R0, R2, -R0 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction FADD R0, R2, -R0 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @!P1 FMUL R0, R0, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P1 FMUL R0, R0, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction MUFU.EX2 R0, R0 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @P0 FADD R4, R44, -R10 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @P0 FADD R4, R44, -R10 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @!P4 FMUL R4, R4, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P4 FMUL R4, R4, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @P0 MUFU.EX2 R4, R4 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @P6 FADD R4, R43, -R10 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @P6 FADD R4, R43, -R10 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @!P4 FMUL R4, R4, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P4 FMUL R4, R4, 0.5 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 1 of instruction @P6 MUFU.EX2 R4, R4 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [div0] detected in operand 1 of instruction @!P2 MUFU.RCP R2, R2 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
#nixnan: error [infinity] detected in operand 0 of instruction @!P2 MUFU.RCP R2, R2 ; in function fmha_cutlassF_f32_aligned_64x64_rf_sm80 at line 0 of type f32
CUDA: [nan, nan, nan]
#nixnan: Finalizing GPU context...

#nixnan: ------------ nixnan Report -----------

#nixnan: --- FP16 Operations ---
#nixnan: NaN:           0
#nixnan: Infinity:      0
#nixnan: Subnormal:     0
#nixnan: Division by 0: 0

#nixnan: --- FP32 Operations ---
#nixnan: NaN:           4
#nixnan: Infinity:      38
#nixnan: Subnormal:     0
#nixnan: Division by 0: 1

#nixnan: --- FP64 Operations ---
#nixnan: NaN:           0
#nixnan: Infinity:      0
#nixnan: Subnormal:     0
#nixnan: Division by 0: 0

[?2004h]0;ganesh@dknuth: ~/repos/pytorch/issue-156707[01;32mganesh@dknuth[00m:[01;34m~/repos/pytorch/issue-156707[00m$ 
Script done on 2025-07-13 16:16:23-06:00 [COMMAND_EXIT_CODE="0"]
